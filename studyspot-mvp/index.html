<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudySpot MVP - å­¦ç¿’å ´æ‰€æ¤œç´¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 32px;
        }
        
        .header h1 {
            color: #007AFF;
            font-size: 32px;
            margin-bottom: 8px;
        }
        
        .header p {
            color: #666;
            font-size: 16px;
        }
        
        .filters {
            background-color: #fff;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 24px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .filters h3 {
            margin-bottom: 12px;
            font-size: 16px;
        }
        
        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }
        
        .filter-item label {
            display: block;
            margin-bottom: 4px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .filter-item select {
            width: 100%;
            padding: 6px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        
        .checkbox-label {
            display: flex !important;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .results-header {
            margin-bottom: 16px;
        }
        
        .results-header h2 {
            font-size: 20px;
            margin-bottom: 8px;
        }
        
        .results-info {
            color: #666;
            font-size: 14px;
        }
        
        .location-card {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 16px;
            margin: 8px 0;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: box-shadow 0.2s;
        }
        
        .location-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .location-card h3 {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .location-meta {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .category-tag {
            background-color: #007AFF;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .distance {
            color: #666;
            font-size: 14px;
        }
        
        .status {
            font-size: 12px;
            font-weight: 500;
        }
        
        .status.open { color: #00C851; }
        .status.closed { color: #FF3547; }
        
        .address {
            color: #666;
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .hours {
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .pricing {
            font-size: 14px;
            font-weight: 500;
            color: #007AFF;
            margin-bottom: 12px;
        }
        
        .rating {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .stars {
            color: #FFD700;
        }
        
        .rating-text {
            font-size: 14px;
            color: #666;
        }
        
        .facilities {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .facility-tag {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .facility-wifi { background-color: #E3F2FD; color: #1976D2; }
        .facility-power { background-color: #E8F5E8; color: #2E7D32; }
        .facility-quiet { background-color: #F3E5F5; color: #7B1FA2; }
        .facility-food { background-color: #FFF3E0; color: #F57C00; }
        
        .no-results {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        
        .modal-content {
            background-color: #fff;
            margin: 50px auto;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .close-btn {
            background-color: #007AFF;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 20px;
        }
        
        .close-btn:hover {
            background-color: #0056b3;
        }
        
        .detail-section {
            margin-bottom: 20px;
        }
        
        .detail-section h3 {
            margin-bottom: 8px;
        }
        
        .hours-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 8px;
        }
        
        .hours-item {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
        }
        
        .facilities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 8px;
        }
        
        .facility-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tags {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .tag {
            background-color: #E3F2FD;
            color: #1976D2;
            padding: 4px 8px;
            border-radius: 16px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <header class="header">
            <h1>ğŸ“š StudySpot</h1>
            <p>ã‚ãªãŸã«æœ€é©ãªå­¦ç¿’å ´æ‰€ã‚’è¦‹ã¤ã‘ã‚ˆã†</p>
        </header>

        <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
        <div class="filters">
            <h3>ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</h3>
            <div class="filter-grid">
                <div class="filter-item">
                    <label>è·é›¢</label>
                    <select id="distanceFilter">
                        <option value="500">500mä»¥å†…</option>
                        <option value="1000">1kmä»¥å†…</option>
                        <option value="2000">2kmä»¥å†…</option>
                        <option value="5000" selected>5kmä»¥å†…</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label>ã‚«ãƒ†ã‚´ãƒª</label>
                    <select id="categoryFilter">
                        <option value="all">ã™ã¹ã¦</option>
                        <option value="library">å›³æ›¸é¤¨</option>
                        <option value="cafe">ã‚«ãƒ•ã‚§</option>
                        <option value="study_room">è‡ªç¿’å®¤</option>
                        <option value="coworking">ã‚³ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚¹ãƒšãƒ¼ã‚¹</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label class="checkbox-label">
                        <input type="checkbox" id="freeOnlyFilter">
                        ç„¡æ–™ã®ã¿
                    </label>
                </div>
            </div>
        </div>

        <!-- æ¤œç´¢çµæœ -->
        <div class="results-header">
            <h2 id="resultsCount">æ¤œç´¢çµæœ (4ä»¶)</h2>
            <p class="results-info" id="locationInfo">ç¾åœ¨åœ°ã‹ã‚‰è¿‘ã„é †ã«è¡¨ç¤ºã—ã¦ã„ã¾ã™</p>
        </div>

        <!-- å ´æ‰€ä¸€è¦§ -->
        <div id="locationsList">
            <!-- å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ -->
        </div>
    </div>

    <!-- è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="detailModal" class="modal">
        <div class="modal-content" id="modalContent">
            <!-- å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ -->
        </div>
    </div>

    <script>
        // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
        const sampleLocations = [
            {
                id: '1',
                name: 'æ–°å®¿åŒºç«‹ä¸­å¤®å›³æ›¸é¤¨',
                category: 'library',
                address: 'æ±äº¬éƒ½æ–°å®¿åŒºå¤§ä¹…ä¿3-1-1',
                coordinates: { latitude: 35.7008, longitude: 139.7003 },
                basicInfo: {
                    openingHours: {
                        monday: '09:00-20:00',
                        tuesday: '09:00-20:00',
                        wednesday: '09:00-20:00',
                        thursday: '09:00-20:00',
                        friday: '09:00-20:00',
                        saturday: '09:00-17:00',
                        sunday: '09:00-17:00'
                    },
                    pricing: { type: 'free' },
                    contact: {
                        phone: '03-3208-2111',
                        website: 'https://www.library.shinjuku.tokyo.jp/'
                    }
                },
                facilities: { wifi: true, power: true, food: false, quiet: true },
                stats: {
                    averageRating: 4.2,
                    reviewCount: 15,
                    tags: { 'é™ã‹': 12, 'Wi-Fiè‰¯å¥½': 10, 'é›»æºã‚ã‚Š': 14, 'é•·æ™‚é–“OK': 8 }
                }
            },
            {
                id: '2',
                name: 'ãƒ‰ãƒˆãƒ¼ãƒ«ã‚³ãƒ¼ãƒ’ãƒ¼ æ–°å®¿æ±å£åº—',
                category: 'cafe',
                address: 'æ±äº¬éƒ½æ–°å®¿åŒºæ–°å®¿3-24-3',
                coordinates: { latitude: 35.6895, longitude: 139.7006 },
                basicInfo: {
                    openingHours: {
                        monday: '07:00-22:00',
                        tuesday: '07:00-22:00',
                        wednesday: '07:00-22:00',
                        thursday: '07:00-22:00',
                        friday: '07:00-22:00',
                        saturday: '07:00-22:00',
                        sunday: '07:00-21:00'
                    },
                    pricing: { type: 'hourly', hourlyRate: 300 },
                    contact: { phone: '03-3123-4567' }
                },
                facilities: { wifi: true, power: false, food: true, quiet: false },
                stats: {
                    averageRating: 3.8,
                    reviewCount: 23,
                    tags: { 'Wi-Fiè‰¯å¥½': 18, 'ã‚¢ã‚¯ã‚»ã‚¹è‰¯å¥½': 20, 'å®‰ã„': 15, 'é›»æºã‚ã‚Š': 5 }
                }
            },
            {
                id: '3',
                name: 'ã‚¹ã‚¿ãƒ‡ã‚£ãƒ«ãƒ¼ãƒ LEAF æ–°å®¿åº—',
                category: 'study_room',
                address: 'æ±äº¬éƒ½æ–°å®¿åŒºè¥¿æ–°å®¿1-1-8',
                coordinates: { latitude: 35.6896, longitude: 139.6917 },
                basicInfo: {
                    openingHours: {
                        monday: '08:00-23:00',
                        tuesday: '08:00-23:00',
                        wednesday: '08:00-23:00',
                        thursday: '08:00-23:00',
                        friday: '08:00-23:00',
                        saturday: '08:00-23:00',
                        sunday: '08:00-22:00'
                    },
                    pricing: { type: 'hourly', hourlyRate: 500, dailyRate: 1500 },
                    contact: {
                        phone: '03-5321-1234',
                        website: 'https://studyroom-leaf.com/'
                    }
                },
                facilities: { wifi: true, power: true, food: false, quiet: true },
                stats: {
                    averageRating: 4.5,
                    reviewCount: 8,
                    tags: { 'é™ã‹': 8, 'Wi-Fiè‰¯å¥½': 7, 'é›»æºã‚ã‚Š': 8, 'é•·æ™‚é–“OK': 6 }
                }
            },
            {
                id: '4',
                name: 'æ¸‹è°·åŒºç«‹ä¸­å¤®å›³æ›¸é¤¨',
                category: 'library',
                address: 'æ±äº¬éƒ½æ¸‹è°·åŒºå®‡ç”°å·ç”º25-1',
                coordinates: { latitude: 35.6598, longitude: 139.6982 },
                basicInfo: {
                    openingHours: {
                        monday: 'ä¼‘é¤¨',
                        tuesday: '10:00-21:00',
                        wednesday: '10:00-21:00',
                        thursday: '10:00-21:00',
                        friday: '10:00-21:00',
                        saturday: '10:00-19:00',
                        sunday: '10:00-17:00'
                    },
                    pricing: { type: 'free' },
                    contact: { phone: '03-3463-1211' }
                },
                facilities: { wifi: true, power: true, food: false, quiet: true },
                stats: {
                    averageRating: 4.0,
                    reviewCount: 12,
                    tags: { 'é™ã‹': 10, 'Wi-Fiè‰¯å¥½': 8, 'é›»æºã‚ã‚Š': 11, 'ã‚¢ã‚¯ã‚»ã‚¹è‰¯å¥½': 9 }
                }
            }
        ];

        // ç¾åœ¨ä½ç½®ï¼ˆæ–°å®¿é§…ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
        let userLocation = { latitude: 35.6896, longitude: 139.7006 };
        let filteredLocations = [...sampleLocations];

        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function calculateDistance(coord1, coord2) {
            const R = 6371;
            const dLat = toRad(coord2.latitude - coord1.latitude);
            const dLon = toRad(coord2.longitude - coord1.longitude);
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                      Math.cos(toRad(coord1.latitude)) * Math.cos(toRad(coord2.latitude)) * 
                      Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return Math.round(R * c * 10) / 10;
        }

        function toRad(value) {
            return value * Math.PI / 180;
        }

        function getCategoryLabel(category) {
            const labels = {
                library: 'å›³æ›¸é¤¨',
                cafe: 'ã‚«ãƒ•ã‚§',
                study_room: 'è‡ªç¿’å®¤',
                coworking: 'ã‚³ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚¹ãƒšãƒ¼ã‚¹',
                public: 'å…¬å…±æ–½è¨­'
            };
            return labels[category] || category;
        }

        function formatPricing(pricing) {
            if (pricing.type === 'free') return 'ç„¡æ–™';
            if (pricing.type === 'hourly') return `æ™‚é–“åˆ¶ ${pricing.hourlyRate}å††/æ™‚é–“`;
            if (pricing.type === 'daily') return `1æ—¥ ${pricing.dailyRate}å††`;
            return 'æ–™é‡‘è¦ç¢ºèª';
        }

        function isCurrentlyOpen(openingHours) {
            const now = new Date();
            const today = now.toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase();
            const currentTime = now.getHours() * 100 + now.getMinutes();
            
            const todayHours = openingHours[today];
            if (!todayHours || todayHours === 'ä¼‘é¤¨') return false;
            
            const [open, close] = todayHours.split('-');
            if (!open || !close) return false;
            
            const openTime = parseInt(open.replace(':', ''));
            const closeTime = parseInt(close.replace(':', ''));
            
            return currentTime >= openTime && currentTime <= closeTime;
        }

        function getTodayHours(openingHours) {
            const today = new Date().toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase();
            const dayLabels = {
                monday: 'æœˆ', tuesday: 'ç«', wednesday: 'æ°´', thursday: 'æœ¨',
                friday: 'é‡‘', saturday: 'åœŸ', sunday: 'æ—¥'
            };
            
            const todayHours = openingHours[today];
            if (todayHours === 'ä¼‘é¤¨') return 'æœ¬æ—¥ä¼‘æ¥­';
            return `æœ¬æ—¥ï¼ˆ${dayLabels[today]}ï¼‰${todayHours}`;
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
        function applyFilters() {
            const distanceFilter = parseInt(document.getElementById('distanceFilter').value);
            const categoryFilter = document.getElementById('categoryFilter').value;
            const freeOnlyFilter = document.getElementById('freeOnlyFilter').checked;

            filteredLocations = sampleLocations.filter(location => {
                // è·é›¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                const distance = calculateDistance(userLocation, location.coordinates);
                if (distance > distanceFilter / 1000) return false;

                // ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                if (categoryFilter !== 'all' && location.category !== categoryFilter) return false;

                // ç„¡æ–™ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                if (freeOnlyFilter && location.basicInfo.pricing.type !== 'free') return false;

                return true;
            });

            // è·é›¢é †ã§ã‚½ãƒ¼ãƒˆ
            filteredLocations.sort((a, b) => {
                const distanceA = calculateDistance(userLocation, a.coordinates);
                const distanceB = calculateDistance(userLocation, b.coordinates);
                return distanceA - distanceB;
            });

            renderLocationsList();
        }

        // å ´æ‰€ä¸€è¦§ã®æç”»
        function renderLocationsList() {
            const container = document.getElementById('locationsList');
            const resultsCount = document.getElementById('resultsCount');
            
            resultsCount.textContent = `æ¤œç´¢çµæœ (${filteredLocations.length}ä»¶)`;

            if (filteredLocations.length === 0) {
                container.innerHTML = `
                    <div class="no-results">
                        <h3>è©²å½“ã™ã‚‹å ´æ‰€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</h3>
                        <p>ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã‚’å¤‰æ›´ã—ã¦ã¿ã¦ãã ã•ã„</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredLocations.map(location => {
                const distance = calculateDistance(userLocation, location.coordinates);
                const isOpen = isCurrentlyOpen(location.basicInfo.openingHours);
                const todayHours = getTodayHours(location.basicInfo.openingHours);
                const pricing = formatPricing(location.basicInfo.pricing);
                
                return `
                    <div class="location-card" onclick="showLocationDetail('${location.id}')">
                        <h3>${location.name}</h3>
                        <div class="location-meta">
                            <span class="category-tag">${getCategoryLabel(location.category)}</span>
                            <span class="distance">${distance}km</span>
                            <span class="status ${isOpen ? 'open' : 'closed'}">${isOpen ? 'å–¶æ¥­ä¸­' : 'ä¼‘æ¥­ä¸­'}</span>
                        </div>
                        <p class="address">ğŸ“ ${location.address}</p>
                        <div class="hours">${todayHours}</div>
                        <div class="pricing">${pricing}</div>
                        <div class="rating">
                            <span class="stars">${'â˜…'.repeat(Math.round(location.stats.averageRating))}${'â˜†'.repeat(5 - Math.round(location.stats.averageRating))}</span>
                            <span class="rating-text">${location.stats.averageRating} (${location.stats.reviewCount}ä»¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼)</span>
                        </div>
                        <div class="facilities">
                            ${location.facilities.wifi ? '<span class="facility-tag facility-wifi">Wi-Fi</span>' : ''}
                            ${location.facilities.power ? '<span class="facility-tag facility-power">é›»æº</span>' : ''}
                            ${location.facilities.quiet ? '<span class="facility-tag facility-quiet">é™ã‹</span>' : ''}
                            ${location.facilities.food ? '<span class="facility-tag facility-food">é£²é£ŸOK</span>' : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // è©³ç´°è¡¨ç¤º
        function showLocationDetail(locationId) {
            const location = sampleLocations.find(l => l.id === locationId);
            if (!location) return;

            const modal = document.getElementById('detailModal');
            const content = document.getElementById('modalContent');
            
            const dayLabels = {
                monday: 'æœˆæ›œæ—¥', tuesday: 'ç«æ›œæ—¥', wednesday: 'æ°´æ›œæ—¥', thursday: 'æœ¨æ›œæ—¥',
                friday: 'é‡‘æ›œæ—¥', saturday: 'åœŸæ›œæ—¥', sunday: 'æ—¥æ›œæ—¥'
            };

            content.innerHTML = `
                <button class="close-btn" onclick="closeModal()">â† æ¤œç´¢çµæœã«æˆ»ã‚‹</button>
                
                <h1>${location.name}</h1>
                <div style="margin-bottom: 16px;">
                    <span class="category-tag">${getCategoryLabel(location.category)}</span>
                </div>
                <p style="margin-bottom: 16px; color: #666;">ğŸ“ ${location.address}</p>

                <div class="detail-section">
                    <h3>å–¶æ¥­æ™‚é–“</h3>
                    <div class="hours-grid">
                        ${Object.entries(location.basicInfo.openingHours).map(([day, hours]) => 
                            `<div class="hours-item">
                                <span>${dayLabels[day]}:</span>
                                <span>${hours}</span>
                            </div>`
                        ).join('')}
                    </div>
                </div>

                <div class="detail-section">
                    <h3>æ–™é‡‘</h3>
                    <p style="font-size: 18px; font-weight: bold; color: #007AFF;">
                        ${formatPricing(location.basicInfo.pricing)}
                    </p>
                </div>

                <div class="detail-section">
                    <h3>è¨­å‚™ãƒ»ç’°å¢ƒ</h3>
                    <div class="facilities-grid">
                        <div class="facility-item">
                            <span>${location.facilities.wifi ? 'âœ…' : 'âŒ'}</span>
                            <span>Wi-Fi</span>
                        </div>
                        <div class="facility-item">
                            <span>${location.facilities.power ? 'âœ…' : 'âŒ'}</span>
                            <span>é›»æº</span>
                        </div>
                        <div class="facility-item">
                            <span>${location.facilities.quiet ? 'âœ…' : 'âŒ'}</span>
                            <span>é™ã‹ãªç’°å¢ƒ</span>
                        </div>
                        <div class="facility-item">
                            <span>${location.facilities.food ? 'âœ…' : 'âŒ'}</span>
                            <span>é£²é£Ÿå¯èƒ½</span>
                        </div>
                    </div>
                </div>

                <div class="detail-section">
                    <h3>è©•ä¾¡ãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼</h3>
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                        <div style="font-size: 24px; color: #FFD700;">
                            ${'â˜…'.repeat(Math.round(location.stats.averageRating))}${'â˜†'.repeat(5 - Math.round(location.stats.averageRating))}
                        </div>
                        <span style="font-size: 18px; font-weight: bold;">${location.stats.averageRating}</span>
                        <span style="color: #666;">(${location.stats.reviewCount}ä»¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼)</span>
                    </div>
                    <div class="tags">
                        ${Object.entries(location.stats.tags).map(([tag, count]) => 
                            `<span class="tag">#${tag} (${count})</span>`
                        ).join('')}
                    </div>
                </div>

                ${location.basicInfo.contact ? `
                    <div class="detail-section">
                        <h3>ãŠå•ã„åˆã‚ã›</h3>
                        ${location.basicInfo.contact.phone ? `<p>ğŸ“ ${location.basicInfo.contact.phone}</p>` : ''}
                        ${location.basicInfo.contact.website ? `<p>ğŸŒ <a href="${location.basicInfo.contact.website}" target="_blank">ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ</a></p>` : ''}
                    </div>
                ` : ''}
            `;

            modal.style.display = 'block';
        }

        function closeModal() {
            document.getElementById('detailModal').style.display = 'none';
        }

        // ä½ç½®æƒ…å ±å–å¾—
        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        userLocation = {
                            latitude: position.coords.latitude,
                            longitude: position.coords.longitude
                        };
                        applyFilters();
                        document.getElementById('locationInfo').textContent = 'ç¾åœ¨åœ°ã‹ã‚‰è¿‘ã„é †ã«è¡¨ç¤ºã—ã¦ã„ã¾ã™';
                    },
                    (error) => {
                        console.log('ä½ç½®æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
                        document.getElementById('locationInfo').textContent = 'æ–°å®¿é§…ã‹ã‚‰ã®è·é›¢ã§è¡¨ç¤ºã—ã¦ã„ã¾ã™ï¼ˆä½ç½®æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸï¼‰';
                        applyFilters();
                    }
                );
            }
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        document.getElementById('distanceFilter').addEventListener('change', applyFilters);
        document.getElementById('categoryFilter').addEventListener('change', applyFilters);
        document.getElementById('freeOnlyFilter').addEventListener('change', applyFilters);

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®å¤–å´ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
        document.getElementById('detailModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // åˆæœŸåŒ–
        getCurrentLocation();
    </script>
</body>
</html>
