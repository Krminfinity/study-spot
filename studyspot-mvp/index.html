<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudySpot MVP - Â≠¶ÁøíÂ†¥ÊâÄÊ§úÁ¥¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 32px;
        }
        
        .header h1 {
            color: #007AFF;
            font-size: 32px;
            margin-bottom: 8px;
        }
        
        .header p {
            color: #666;
            font-size: 16px;
        }
        
        .filters {
            background-color: #fff;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 24px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .filters h3 {
            margin-bottom: 12px;
            font-size: 16px;
        }
        
        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }
        
        .filter-item label {
            display: block;
            margin-bottom: 4px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .filter-item select {
            width: 100%;
            padding: 6px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        
        .checkbox-label {
            display: flex !important;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .results-header {
            margin-bottom: 16px;
        }
        
        .results-header h2 {
            font-size: 20px;
            margin-bottom: 8px;
        }
        
        .results-info {
            color: #666;
            font-size: 14px;
        }
        
        .location-card {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 16px;
            margin: 8px 0;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: box-shadow 0.2s;
        }
        
        .location-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .location-card h3 {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .location-meta {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .category-tag {
            background-color: #007AFF;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .distance {
            color: #666;
            font-size: 14px;
        }
        
        .status {
            font-size: 12px;
            font-weight: 500;
        }
        
        .status.open { color: #00C851; }
        .status.closed { color: #FF3547; }
        
        .address {
            color: #666;
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .hours {
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .pricing {
            font-size: 14px;
            font-weight: 500;
            color: #007AFF;
            margin-bottom: 12px;
        }
        
        .rating {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .stars {
            color: #FFD700;
        }
        
        .rating-text {
            font-size: 14px;
            color: #666;
        }
        
        .facilities {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .facility-tag {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .facility-wifi { background-color: #E3F2FD; color: #1976D2; }
        .facility-power { background-color: #E8F5E8; color: #2E7D32; }
        .facility-quiet { background-color: #F3E5F5; color: #7B1FA2; }
        .facility-food { background-color: #FFF3E0; color: #F57C00; }
        
        .no-results {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        
        .modal-content {
            background-color: #fff;
            margin: 50px auto;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .close-btn {
            background-color: #007AFF;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 20px;
        }
        
        .close-btn:hover {
            background-color: #0056b3;
        }
        
        .detail-section {
            margin-bottom: 20px;
        }
        
        .detail-section h3 {
            margin-bottom: 8px;
        }
        
        .hours-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 8px;
        }
        
        .hours-item {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
        }
        
        .facilities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 8px;
        }
        
        .facility-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tags {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .tag {
            background-color: #E3F2FD;
            color: #1976D2;
            padding: 4px 8px;
            border-radius: 16px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- „Éò„ÉÉ„ÉÄ„Éº -->
        <header class="header">
            <h1>üìö StudySpot</h1>
            <p>„ÅÇ„Å™„Åü„Å´ÊúÄÈÅ©„Å™Â≠¶ÁøíÂ†¥ÊâÄ„ÇíË¶ã„Å§„Åë„Çà„ÅÜ</p>
        </header>

        <!-- „Éï„Ç£„É´„Çø„Éº -->
        <div class="filters">
            <h3>„Éï„Ç£„É´„Çø„Éº</h3>
            <div class="filter-grid">
                <div class="filter-item">
                    <label>Ë∑ùÈõ¢</label>
                    <select id="distanceFilter">
                        <option value="500">500m‰ª•ÂÜÖ</option>
                        <option value="1000">1km‰ª•ÂÜÖ</option>
                        <option value="2000">2km‰ª•ÂÜÖ</option>
                        <option value="5000" selected>5km‰ª•ÂÜÖ</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label>„Ç´„ÉÜ„Ç¥„É™</label>
                    <select id="categoryFilter">
                        <option value="all">„Åô„Åπ„Å¶</option>
                        <option value="library">Âõ≥Êõ∏È§®</option>
                        <option value="cafe">„Ç´„Éï„Çß</option>
                        <option value="study_room">Ëá™ÁøíÂÆ§</option>
                        <option value="coworking">„Ç≥„ÉØ„Éº„Ç≠„É≥„Ç∞„Çπ„Éö„Éº„Çπ</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label class="checkbox-label">
                        <input type="checkbox" id="freeOnlyFilter">
                        ÁÑ°Êñô„ÅÆ„Åø
                    </label>
                </div>
            </div>
        </div>

        <!-- Ê§úÁ¥¢ÁµêÊûú -->
        <div class="results-header">
            <h2 id="resultsCount">Ê§úÁ¥¢ÁµêÊûú (4‰ª∂)</h2>
            <p class="results-info" id="locationInfo">ÁèæÂú®Âú∞„Åã„ÇâËøë„ÅÑÈ†Ü„Å´Ë°®Á§∫„Åó„Å¶„ÅÑ„Åæ„Åô</p>
        </div>

        <!-- Â†¥ÊâÄ‰∏ÄË¶ß -->
        <div id="locationsList">
            <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Çã -->
        </div>
    </div>

    <!-- Ë©≥Á¥∞„É¢„Éº„ÉÄ„É´ -->
    <div id="detailModal" class="modal">
        <div class="modal-content" id="modalContent">
            <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Çã -->
        </div>
    </div>

    <script>
        // „Çµ„É≥„Éó„É´„Éá„Éº„Çø
        const sampleLocations = [
            {
                id: '1',
                name: 'Êñ∞ÂÆøÂå∫Á´ã‰∏≠Â§ÆÂõ≥Êõ∏È§®',
                category: 'library',
                address: 'Êù±‰∫¨ÈÉΩÊñ∞ÂÆøÂå∫Â§ß‰πÖ‰øù3-1-1',
                coordinates: { latitude: 35.7008, longitude: 139.7003 },
                basicInfo: {
                    openingHours: {
                        monday: '09:00-20:00',
                        tuesday: '09:00-20:00',
                        wednesday: '09:00-20:00',
                        thursday: '09:00-20:00',
                        friday: '09:00-20:00',
                        saturday: '09:00-17:00',
                        sunday: '09:00-17:00'
                    },
                    pricing: { type: 'free' },
                    contact: {
                        phone: '03-3208-2111',
                        website: 'https://www.library.shinjuku.tokyo.jp/'
                    }
                },
                facilities: { wifi: true, power: true, food: false, quiet: true },
                stats: {
                    averageRating: 4.2,
                    reviewCount: 15,
                    tags: { 'Èùô„Åã': 12, 'Wi-FiËâØÂ•Ω': 10, 'ÈõªÊ∫ê„ÅÇ„Çä': 14, 'Èï∑ÊôÇÈñìOK': 8 }
                }
            },
            {
                id: '2',
                name: '„Éâ„Éà„Éº„É´„Ç≥„Éº„Éí„Éº Êñ∞ÂÆøÊù±Âè£Â∫ó',
                category: 'cafe',
                address: 'Êù±‰∫¨ÈÉΩÊñ∞ÂÆøÂå∫Êñ∞ÂÆø3-24-3',
                coordinates: { latitude: 35.6895, longitude: 139.7006 },
                basicInfo: {
                    openingHours: {
                        monday: '07:00-22:00',
                        tuesday: '07:00-22:00',
                        wednesday: '07:00-22:00',
                        thursday: '07:00-22:00',
                        friday: '07:00-22:00',
                        saturday: '07:00-22:00',
                        sunday: '07:00-21:00'
                    },
                    pricing: { type: 'hourly', hourlyRate: 300 },
                    contact: { phone: '03-3123-4567' }
                },
                facilities: { wifi: true, power: false, food: true, quiet: false },
                stats: {
                    averageRating: 3.8,
                    reviewCount: 23,
                    tags: { 'Wi-FiËâØÂ•Ω': 18, '„Ç¢„ÇØ„Çª„ÇπËâØÂ•Ω': 20, 'ÂÆâ„ÅÑ': 15, 'ÈõªÊ∫ê„ÅÇ„Çä': 5 }
                }
            },
            {
                id: '3',
                name: '„Çπ„Çø„Éá„Ç£„É´„Éº„É†LEAF Êñ∞ÂÆøÂ∫ó',
                category: 'study_room',
                address: 'Êù±‰∫¨ÈÉΩÊñ∞ÂÆøÂå∫Ë•øÊñ∞ÂÆø1-1-8',
                coordinates: { latitude: 35.6896, longitude: 139.6917 },
                basicInfo: {
                    openingHours: {
                        monday: '08:00-23:00',
                        tuesday: '08:00-23:00',
                        wednesday: '08:00-23:00',
                        thursday: '08:00-23:00',
                        friday: '08:00-23:00',
                        saturday: '08:00-23:00',
                        sunday: '08:00-22:00'
                    },
                    pricing: { type: 'hourly', hourlyRate: 500, dailyRate: 1500 },
                    contact: {
                        phone: '03-5321-1234',
                        website: 'https://studyroom-leaf.com/'
                    }
                },
                facilities: { wifi: true, power: true, food: false, quiet: true },
                stats: {
                    averageRating: 4.5,
                    reviewCount: 8,
                    tags: { 'Èùô„Åã': 8, 'Wi-FiËâØÂ•Ω': 7, 'ÈõªÊ∫ê„ÅÇ„Çä': 8, 'Èï∑ÊôÇÈñìOK': 6 }
                }
            },
            {
                id: '4',
                name: 'Ê∏ãË∞∑Âå∫Á´ã‰∏≠Â§ÆÂõ≥Êõ∏È§®',
                category: 'library',
                address: 'Êù±‰∫¨ÈÉΩÊ∏ãË∞∑Âå∫ÂÆáÁî∞Â∑ùÁî∫25-1',
                coordinates: { latitude: 35.6598, longitude: 139.6982 },
                basicInfo: {
                    openingHours: {
                        monday: '‰ºëÈ§®',
                        tuesday: '10:00-21:00',
                        wednesday: '10:00-21:00',
                        thursday: '10:00-21:00',
                        friday: '10:00-21:00',
                        saturday: '10:00-19:00',
                        sunday: '10:00-17:00'
                    },
                    pricing: { type: 'free' },
                    contact: { phone: '03-3463-1211' }
                },
                facilities: { wifi: true, power: true, food: false, quiet: true },
                stats: {
                    averageRating: 4.0,
                    reviewCount: 12,
                    tags: { 'Èùô„Åã': 10, 'Wi-FiËâØÂ•Ω': 8, 'ÈõªÊ∫ê„ÅÇ„Çä': 11, '„Ç¢„ÇØ„Çª„ÇπËâØÂ•Ω': 9 }
                }
            }
        ];

        // ÁèæÂú®‰ΩçÁΩÆÔºàÊñ∞ÂÆøÈßÖ„Çí„Éá„Éï„Ç©„É´„ÉàÔºâ
        let userLocation = { latitude: 35.6896, longitude: 139.7006 };
        let filteredLocations = [...sampleLocations];

        // „É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£Èñ¢Êï∞
        function calculateDistance(coord1, coord2) {
            const R = 6371;
            const dLat = toRad(coord2.latitude - coord1.latitude);
            const dLon = toRad(coord2.longitude - coord1.longitude);
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                      Math.cos(toRad(coord1.latitude)) * Math.cos(toRad(coord2.latitude)) * 
                      Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return Math.round(R * c * 10) / 10;
        }

        function toRad(value) {
            return value * Math.PI / 180;
        }

        function getCategoryLabel(category) {
            const labels = {
                library: 'Âõ≥Êõ∏È§®',
                cafe: '„Ç´„Éï„Çß',
                study_room: 'Ëá™ÁøíÂÆ§',
                coworking: '„Ç≥„ÉØ„Éº„Ç≠„É≥„Ç∞„Çπ„Éö„Éº„Çπ',
                public: 'ÂÖ¨ÂÖ±ÊñΩË®≠'
            };
            return labels[category] || category;
        }

        function formatPricing(pricing) {
            if (pricing.type === 'free') return 'ÁÑ°Êñô';
            if (pricing.type === 'hourly') return `ÊôÇÈñìÂà∂ ${pricing.hourlyRate}ÂÜÜ/ÊôÇÈñì`;
            if (pricing.type === 'daily') return `1Êó• ${pricing.dailyRate}ÂÜÜ`;
            return 'ÊñôÈáëË¶ÅÁ¢∫Ë™ç';
        }

        function isCurrentlyOpen(openingHours) {
            const now = new Date();
            const today = now.toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase();
            const currentTime = now.getHours() * 100 + now.getMinutes();
            
            const todayHours = openingHours[today];
            if (!todayHours || todayHours === '‰ºëÈ§®') return false;
            
            const [open, close] = todayHours.split('-');
            if (!open || !close) return false;
            
            const openTime = parseInt(open.replace(':', ''));
            const closeTime = parseInt(close.replace(':', ''));
            
            return currentTime >= openTime && currentTime <= closeTime;
        }

        function getTodayHours(openingHours) {
            const today = new Date().toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase();
            const dayLabels = {
                monday: 'Êúà', tuesday: 'ÁÅ´', wednesday: 'Ê∞¥', thursday: 'Êú®',
                friday: 'Èáë', saturday: 'Âúü', sunday: 'Êó•'
            };
            
            const todayHours = openingHours[today];
            if (todayHours === '‰ºëÈ§®') return 'Êú¨Êó•‰ºëÊ•≠';
            return `Êú¨Êó•Ôºà${dayLabels[today]}Ôºâ${todayHours}`;
        }

        // „Éï„Ç£„É´„Çø„ÉºÈÅ©Áî®
        function applyFilters() {
            const distanceFilter = parseInt(document.getElementById('distanceFilter').value);
            const categoryFilter = document.getElementById('categoryFilter').value;
            const freeOnlyFilter = document.getElementById('freeOnlyFilter').checked;

            filteredLocations = sampleLocations.filter(location => {
                // Ë∑ùÈõ¢„Éï„Ç£„É´„Çø„Éº
                const distance = calculateDistance(userLocation, location.coordinates);
                if (distance > distanceFilter / 1000) return false;

                // „Ç´„ÉÜ„Ç¥„É™„Éï„Ç£„É´„Çø„Éº
                if (categoryFilter !== 'all' && location.category !== categoryFilter) return false;

                // ÁÑ°Êñô„Éï„Ç£„É´„Çø„Éº
                if (freeOnlyFilter && location.basicInfo.pricing.type !== 'free') return false;

                return true;
            });

            // Ë∑ùÈõ¢È†Ü„Åß„ÇΩ„Éº„Éà
            filteredLocations.sort((a, b) => {
                const distanceA = calculateDistance(userLocation, a.coordinates);
                const distanceB = calculateDistance(userLocation, b.coordinates);
                return distanceA - distanceB;
            });

            renderLocationsList();
        }

        // Â†¥ÊâÄ‰∏ÄË¶ß„ÅÆÊèèÁîª
        function renderLocationsList() {
            const container = document.getElementById('locationsList');
            const resultsCount = document.getElementById('resultsCount');
            
            resultsCount.textContent = `Ê§úÁ¥¢ÁµêÊûú (${filteredLocations.length}‰ª∂)`;

            if (filteredLocations.length === 0) {
                container.innerHTML = `
                    <div class="no-results">
                        <h3>Ë©≤ÂΩì„Åô„ÇãÂ†¥ÊâÄ„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü</h3>
                        <p>„Éï„Ç£„É´„Çø„ÉºÊù°‰ª∂„ÇíÂ§âÊõ¥„Åó„Å¶„Åø„Å¶„Åè„Å†„Åï„ÅÑ</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredLocations.map(location => {
                const distance = calculateDistance(userLocation, location.coordinates);
                const isOpen = isCurrentlyOpen(location.basicInfo.openingHours);
                const todayHours = getTodayHours(location.basicInfo.openingHours);
                const pricing = formatPricing(location.basicInfo.pricing);
                
                return `
                    <div class="location-card" onclick="showLocationDetail('${location.id}')">
                        <h3>${location.name}</h3>
                        <div class="location-meta">
                            <span class="category-tag">${getCategoryLabel(location.category)}</span>
                            <span class="distance">${distance}km</span>
                            <span class="status ${isOpen ? 'open' : 'closed'}">${isOpen ? 'Âñ∂Ê•≠‰∏≠' : '‰ºëÊ•≠‰∏≠'}</span>
                        </div>
                        <p class="address">üìç ${location.address}</p>
                        <div class="hours">${todayHours}</div>
                        <div class="pricing">${pricing}</div>
                        <div class="rating">
                            <span class="stars">${'‚òÖ'.repeat(Math.round(location.stats.averageRating))}${'‚òÜ'.repeat(5 - Math.round(location.stats.averageRating))}</span>
                            <span class="rating-text">${location.stats.averageRating} (${location.stats.reviewCount}‰ª∂„ÅÆ„É¨„Éì„É•„Éº)</span>
                        </div>
                        <div class="facilities">
                            ${location.facilities.wifi ? '<span class="facility-tag facility-wifi">Wi-Fi</span>' : ''}
                            ${location.facilities.power ? '<span class="facility-tag facility-power">ÈõªÊ∫ê</span>' : ''}
                            ${location.facilities.quiet ? '<span class="facility-tag facility-quiet">Èùô„Åã</span>' : ''}
                            ${location.facilities.food ? '<span class="facility-tag facility-food">È£≤È£üOK</span>' : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Ë©≥Á¥∞Ë°®Á§∫
        function showLocationDetail(locationId) {
            const location = sampleLocations.find(l => l.id === locationId);
            if (!location) return;

            const modal = document.getElementById('detailModal');
            const content = document.getElementById('modalContent');
            
            const dayLabels = {
                monday: 'ÊúàÊõúÊó•', tuesday: 'ÁÅ´ÊõúÊó•', wednesday: 'Ê∞¥ÊõúÊó•', thursday: 'Êú®ÊõúÊó•',
                friday: 'ÈáëÊõúÊó•', saturday: 'ÂúüÊõúÊó•', sunday: 'Êó•ÊõúÊó•'
            };

            content.innerHTML = `
                <button class="close-btn" onclick="closeModal()">‚Üê Ê§úÁ¥¢ÁµêÊûú„Å´Êàª„Çã</button>
                
                <h1>${location.name}</h1>
                <div style="margin-bottom: 16px;">
                    <span class="category-tag">${getCategoryLabel(location.category)}</span>
                </div>
                <p style="margin-bottom: 16px; color: #666;">üìç ${location.address}</p>

                <div class="detail-section">
                    <h3>Âñ∂Ê•≠ÊôÇÈñì</h3>
                    <div class="hours-grid">
                        ${Object.entries(location.basicInfo.openingHours).map(([day, hours]) => 
                            `<div class="hours-item">
                                <span>${dayLabels[day]}:</span>
                                <span>${hours}</span>
                            </div>`
                        ).join('')}
                    </div>
                </div>

                <div class="detail-section">
                    <h3>ÊñôÈáë</h3>
                    <p style="font-size: 18px; font-weight: bold; color: #007AFF;">
                        ${formatPricing(location.basicInfo.pricing)}
                    </p>
                </div>

                <div class="detail-section">
                    <h3>Ë®≠ÂÇô„ÉªÁí∞Â¢É</h3>
                    <div class="facilities-grid">
                        <div class="facility-item">
                            <span>${location.facilities.wifi ? '‚úÖ' : '‚ùå'}</span>
                            <span>Wi-Fi</span>
                        </div>
                        <div class="facility-item">
                            <span>${location.facilities.power ? '‚úÖ' : '‚ùå'}</span>
                            <span>ÈõªÊ∫ê</span>
                        </div>
                        <div class="facility-item">
                            <span>${location.facilities.quiet ? '‚úÖ' : '‚ùå'}</span>
                            <span>Èùô„Åã„Å™Áí∞Â¢É</span>
                        </div>
                        <div class="facility-item">
                            <span>${location.facilities.food ? '‚úÖ' : '‚ùå'}</span>
                            <span>È£≤È£üÂèØËÉΩ</span>
                        </div>
                    </div>
                </div>

                <div class="detail-section">
                    <h3>Ë©ï‰æ°„Éª„É¨„Éì„É•„Éº</h3>
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                        <div style="font-size: 24px; color: #FFD700;">
                            ${'‚òÖ'.repeat(Math.round(location.stats.averageRating))}${'‚òÜ'.repeat(5 - Math.round(location.stats.averageRating))}
                        </div>
                        <span style="font-size: 18px; font-weight: bold;">${location.stats.averageRating}</span>
                        <span style="color: #666;">(${location.stats.reviewCount}‰ª∂„ÅÆ„É¨„Éì„É•„Éº)</span>
                    </div>
                    <div class="tags">
                        ${Object.entries(location.stats.tags).map(([tag, count]) => 
                            `<span class="tag">#${tag} (${count})</span>`
                        ).join('')}
                    </div>
                </div>

                ${location.basicInfo.contact ? `
                    <div class="detail-section">
                        <h3>„ÅäÂïè„ÅÑÂêà„Çè„Åõ</h3>
                        ${location.basicInfo.contact.phone ? `<p>üìû ${location.basicInfo.contact.phone}</p>` : ''}
                        ${location.basicInfo.contact.website ? `<p>üåê <a href="${location.basicInfo.contact.website}" target="_blank">„Ç¶„Çß„Éñ„Çµ„Ç§„Éà</a></p>` : ''}
                    </div>
                ` : ''}
            `;

            modal.style.display = 'block';
        }

        function closeModal() {
            document.getElementById('detailModal').style.display = 'none';
        }

        // ‰ΩçÁΩÆÊÉÖÂ†±ÂèñÂæó
        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        userLocation = {
                            latitude: position.coords.latitude,
                            longitude: position.coords.longitude
                        };
                        applyFilters();
                        document.getElementById('locationInfo').textContent = 'ÁèæÂú®Âú∞„Åã„ÇâËøë„ÅÑÈ†Ü„Å´Ë°®Á§∫„Åó„Å¶„ÅÑ„Åæ„Åô';
                    },
                    (error) => {
                        console.log('‰ΩçÁΩÆÊÉÖÂ†±„ÅÆÂèñÂæó„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:', error);
                        document.getElementById('locationInfo').textContent = 'Êñ∞ÂÆøÈßÖ„Åã„Çâ„ÅÆË∑ùÈõ¢„ÅßË°®Á§∫„Åó„Å¶„ÅÑ„Åæ„ÅôÔºà‰ΩçÁΩÆÊÉÖÂ†±„ÅÆÂèñÂæó„Å´Â§±Êïó„Åó„Åæ„Åó„ÅüÔºâ';
                        applyFilters();
                    }
                );
            }
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        document.getElementById('distanceFilter').addEventListener('change', applyFilters);
        document.getElementById('categoryFilter').addEventListener('change', applyFilters);
        document.getElementById('freeOnlyFilter').addEventListener('change', applyFilters);

        // „É¢„Éº„ÉÄ„É´„ÅÆÂ§ñÂÅ¥„ÇØ„É™„ÉÉ„ÇØ„ÅßÈñâ„Åò„Çã
        document.getElementById('detailModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // ÂàùÊúüÂåñ
        getCurrentLocation();
    </script>
</body>
</html>
